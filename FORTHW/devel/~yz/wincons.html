<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="stylesheet" href="forth.css" type="text/css">
<title>Библиотека Wincons. Загружаемые константы</title>
</head>

<body background="pic/grid.gif">

<h1><u>wincons.f</u> &nbsp;Загружаемые константы</h1>
<p>А это - мой вклад в решение наболевшей проблемы загрузки констант Windows,
которые даже для небольшой программки требуются тоннами. Насколько я знаю, мои 
коллеги просто описывают их с помощью <u>CONSTANT</u>. Это не только утомительно, но и 
чревато лишними ошибками. Кроме того, все определения констант так и остаются потом
в памяти, когда они там вовсе не нужны. Памяти сейчас у нас, конечно, много, но
все равно жалко. 
<p>Мои константы грузятся в начале компиляции и выгружаются после
ее окончания. Хранятся константы в двоичном файле специального формата, 
оптимизированном для быстрого поиска. Имеется два таких файла:
<a href="http://www.forth.org.ru/~yz/lib/windows.const">windows.const</a>, в который засунуты константы из <i>kernel32.dll</i>,
<i>user32.dll</i>, <i>gdi32.dll</i> и <a href="http://www.forth.org.ru/~yz/lib/commctrl.const">commctrl.const</a>.
Константы регистронезависимы, чтобы ни у кого не возникало проблем, как правильно писать: Win_HangOnKeyDown или
win_HangOnKeydown.

<h2>Список слов</h2>
<u>LOAD-CONSTANTS</u> <i>(a # --)</i>
<p>Загрузить список констант из файла, имя которого задано строкой <i>a #</i>.
Загружать можно несколько файлов подряд, во время поиска они будут просматриваться
по порядку, начиная с последнего загруженного.
<p>Стандартные константы из <i>windows.const</I> грузятся при загрузке библиотеки.
</p>
<u>REMOVE-ALL-CONSTANTS</u> <i>( --)</i>
<p>Удалить из памяти все загруженные списки констант.
</p>
<u>FIND-CONSTANT</u> <i>(a # -- n true / false)</i>
<p>Основное слово для поиска. Ищет константу, заданную строкой <i>a #</i> во всех
загруженные списках констант, начиная с самого последнего, и возвращает числовое
значение найденной константы и true; false - если константа не найдена.</p>

<u>W:</u> <i>( ->bl; -- n)</i>
<p>Выбрать следующее слово, найти его в списке констант и вернуть значение</p>

<u>(*</u> <i>( ->"*)"; -- n)</i>
<p>Выбрать все слова, пока не встретится <u>*)</u>, найти их значения и объединить 
с помощью OR. Вся эта сложная конструкция должна размещаться на одной строке.
</p>

<div class="e">
<font color=gray>Пример</font>
<tt>
<br>S" wincons.f" INCLUDE
<br>...
<br>W: wm_Quit OF ... ENDOF
<br>...
<br>(* ws_Overlapped ws_SysMenu ws_Minimizebox ws_Vscroll ws_Caption *)
</tt>
</div>

</body>
</html>